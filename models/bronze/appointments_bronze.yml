version: 2

models:
  - name: appointments_bronze
    description: Stores appointment details with time information.
    columns:
      - name: APPOINTMENT_ID
        description: The unique key for each appointment.
        tests:
          - not_null
          - unique

      - name: PATIENT_ID
        description: The ID of the patient.
        tests:
          - not_null                
          - relationships:          
              to: ref('patients_bronze')    
              field: PATIENT_ID

      - name: APPOINTMENT_TIME
        description: The time of the appointment.
        tests:
          - not_null                
          - dbt_expectations.expect_column_values_to_be_in_type_list:
                column_type_list: ['time']
      
      - name: APPOINTMENT_DATE
        description: The date of the appointment.
        tests:
          - not_null            
          - dbt_expectations.expect_column_values_to_be_in_type_list:
                column_type_list: ['date']   
          - dbt_expectations.expect_column_values_to_match_regex: # This test needs to be performed on the raw layer
              regex: '^\\d{4}-\\d{2}-\\d{2}$' 
          
